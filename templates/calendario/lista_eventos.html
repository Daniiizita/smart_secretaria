{% extends "core/base.html" %}
{% block title %}Calendário - SmartSecretaria{% endblock %}

{% block content %}
<div class="container">
  <h1>Calendário de Eventos</h1>
  
  {% if messages %}
    <div class="mensagens">
      {% for message in messages %}
        <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
  
  <div class="acoes" style="margin-bottom: 20px; display: flex; justify-content: space-between;">
    <a href="{% url 'calendario:novo_evento' %}">Novo Evento</a>
    <a href="{% url 'calendario:calendario_mensal' %}">Ver Calendário Mensal</a>
  </div>
  
  {% if eventos_andamento %}
    <h2>Eventos em Andamento</h2>
    <div class="eventos-lista">
      {% for evento in eventos_andamento %}
        <div class="evento-card" style="margin-bottom: 15px; padding: 10px; border-left: 4px solid 
          {% if evento.tipo == 'feriado' %}#dc3545
          {% elif evento.tipo == 'reuniao' %}#0d6efd
          {% else %}#198754{% endif %}; 
          background-color: #f8f9fa;">
          <h4><a href="{% url 'calendario:detalhe_evento' evento.pk %}">{{ evento.titulo }}</a></h4>
          <p>
            <strong>Tipo:</strong> 
            {% if evento.tipo == 'feriado' %}Feriado
            {% elif evento.tipo == 'reuniao' %}Reunião
            {% else %}Evento Escolar{% endif %}
          </p>
          <p><strong>Início:</strong> {{ evento.data_inicio }}</p>
          <p><strong>Término:</strong> {{ evento.data_fim }}</p>
          {% if evento.descricao %}
            <p><strong>Descrição:</strong> {{ evento.descricao|truncatechars:100 }}</p>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% endif %}
  
  {% if eventos_futuros %}
    <h2>Próximos Eventos</h2>
    <div class="eventos-lista">
      {% for evento in eventos_futuros %}
        <div class="evento-card" style="margin-bottom: 15px; padding: 10px; border-left: 4px solid 
          {% if evento.tipo == 'feriado' %}#dc3545
          {% elif evento.tipo == 'reuniao' %}#0d6efd
          {% else %}#198754{% endif %}; 
          background-color: #f8f9fa;">
          <h4><a href="{% url 'calendario:detalhe_evento' evento.pk %}">{{ evento.titulo }}</a></h4>
          <p>
            <strong>Tipo:</strong> 
            {% if evento.tipo == 'feriado' %}Feriado
            {% elif evento.tipo == 'reuniao' %}Reunião
            {% else %}Evento Escolar{% endif %}
          </p>
          <p><strong>Início:</strong> {{ evento.data_inicio }}</p>
          <p><strong>Término:</strong> {{ evento.data_fim }}</p>
          {% if evento.descricao %}
            <p><strong>Descrição:</strong> {{ evento.descricao|truncatechars:100 }}</p>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>Não há eventos futuros agendados.</p>
  {% endif %}
  
  {% if eventos_passados %}
    <h2>Eventos Anteriores</h2>
    <div class="eventos-lista">
      {% for evento in eventos_passados|slice:":5" %}
        <div class="evento-card" style="margin-bottom: 15px; padding: 10px; border-left: 4px solid #6c757d; background-color: #f8f9fa; opacity: 0.7;">
          <h4><a href="{% url 'calendario:detalhe_evento' evento.pk %}">{{ evento.titulo }}</a></h4>
          <p>
            <strong>Tipo:</strong> 
            {% if evento.tipo == 'feriado' %}Feriado
            {% elif evento.tipo == 'reuniao' %}Reunião
            {% else %}Evento Escolar{% endif %}
          </p>
          <p><strong>Início:</strong> {{ evento.data_inicio }}</p>
          <p><strong>Término:</strong> {{ evento.data_fim }}</p>
        </div>
      {% endfor %}
    </div>
    {% if eventos_passados.count > 5 %}
      <p><em>Exibindo apenas os 5 eventos anteriores mais recentes.</em></p>
    {% endif %}
  {% endif %}
</div>
{% endblock %}