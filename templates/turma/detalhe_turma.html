{% extends "core/base.html" %}
{% block title %}{{ turma.nome }} - SmartSecretaria{% endblock %}

{% block content %}
<div class="container">
  <h1>Detalhes da Turma</h1>
  
  {% if messages %}
    <div class="mensagens">
      {% for message in messages %}
        <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
  
  <div class="card">
    <div class="card-header">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <h3>{{ turma.nome }}</h3>
        <div>
          <a href="{% url 'turma:editar_turma' turma.id %}">Editar</a>
          <a href="{% url 'turma:excluir_turma' turma.id %}">Excluir</a>
        </div>
      </div>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <dl>
            <dt>Nome da Turma:</dt>
            <dd>{{ turma.nome }}</dd>
            
            <dt>Série:</dt>
            <dd>{{ turma.serie }}º Ano {{ turma.turma_letra }}</dd>
            
            <dt>Professor Responsável:</dt>
            <dd>{{ turma.professor_responsavel.nome }}</dd>
            
            <dt>Ano Letivo:</dt>
            <dd>{{ turma.ano }}</dd>
            
            <dt>Período:</dt>
            <dd>{{ turma.periodo }}</dd>
            
            <dt>Nível de Ensino:</dt>
            <dd>{{ turma.nivel_ensino }} ({{ turma.nivel_ensino_sigla }})</dd>
            
            {% if turma.horario_aulas %}
            <dt>Horário das Aulas:</dt>
            <dd>{{ turma.horario_aulas|linebreaks }}</dd>
            {% endif %}
          </dl>
        </div>
      </div>
      
      <h4>Alunos Matriculados</h4>
      {% if alunos %}
        <table class="table">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Data de Nascimento</th>
              <th>Telefone</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            {% for aluno in alunos %}
              <tr>
                <td>{{ aluno.nome_completo }}</td>
                <td>{{ aluno.data_nascimento }}</td>
                <td>{{ aluno.telefone_contato }}</td>
                <td>
                  <a href="{% url 'aluno:detalhe_aluno' aluno.id %}">Ver</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p>Não há alunos matriculados nesta turma.</p>
      {% endif %}
    </div>
    <div class="card-footer">
      <a href="{% url 'turma:lista_turmas' %}">Voltar para a lista</a>
      <div class="acoes" style="margin-top: 20px;">
        <a href="{% url 'relatorios:alunos_da_turma_excel' turma.id %}" class="btn btn-primary">Exportar em Excel</a>
        <a href="{% url 'relatorios:alunos_da_turma_pdf' turma.id %}" class="btn btn-danger">Exportar em PDF</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}